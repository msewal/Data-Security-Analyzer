{% extends "list/base_table.html" %}
{% load static %}

{% block title %}Virüs Tarama Sonuçları{% endblock %}

{% block table_title %}Virüs Tarama Sonuçları{% endblock %}

{% block table_headers %}
<th>Dosya</th>
<th>Malware Türü</th>
<th>Tarama Aracı</th>
<th>İşlemler</th>
{% endblock %}

{% block table_content %}
{% if error %}
    <tr>
        <td colspan="4" class="text-center text-danger">
            <i class="bi bi-exclamation-triangle"></i> {{ error }}
        </td>
    </tr>
{% elif infected_files %}
    {% for file in infected_files %}
    <tr>
        <td>{{ file.path }}</td>
        <td>{{ file.malware_type }}</td>
        <td>{{ file.tool }}</td>
        <td>
            <a href="{% url 'list:quarantine_list' %}" class="btn btn-sm btn-warning">
                <i class="bi bi-shield-lock"></i> Karantinada Görüntüle
            </a>
        </td>
    </tr>
    {% endfor %}
{% else %}
    <tr>
        <td colspan="4" class="text-center text-success">
            <i class="bi bi-shield-check"></i> Herhangi bir virüs/malware tespit edilmedi.
        </td>
    </tr>
{% endif %}
{% endblock %}

{% block content %}
{{ block.super }}

{% if scan_results %}
<div class="card mt-4">
    <div class="card-header">
        <h5 class="mb-0">Diğer Tarama Sonuçları</h5>
    </div>
    <div class="card-body">
        {% for result in scan_results %}
        <div class="alert alert-warning">
            <strong>{{ result.tool }}:</strong> {{ result.message }}
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if clam_output or rkhunter_output or chkrootkit_output %}
<div class="card mt-4">
    <div class="card-header">
        <h5 class="mb-0">Detaylı Çıktılar</h5>
    </div>
    <div class="card-body">
        {% if clam_output %}
        <h6>ClamAV Çıktısı:</h6>
        <pre class="bg-light p-3">{{ clam_output }}</pre>
        {% endif %}

        {% if rkhunter_output %}
        <h6>RKHunter Çıktısı:</h6>
        <pre class="bg-light p-3">{{ rkhunter_output }}</pre>
        {% endif %}

        {% if chkrootkit_output %}
        <h6>Chkrootkit Çıktısı:</h6>
        <pre class="bg-light p-3">{{ chkrootkit_output }}</pre>
        {% endif %}
    </div>
</div>
{% endif %}
{% endblock %} 